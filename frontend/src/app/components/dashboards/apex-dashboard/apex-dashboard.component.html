<div class="dashboard-container">
  <div class="sidebar">
    <app-sidebar-menu></app-sidebar-menu>
  </div>

  <div class="main-content">
    <p-card header="Apex Dashboard" class="m-4">
      <p><strong>Welcome to the Apex Dashboard!</strong></p>

      <div class="p-fluid mt-4">
        <!-- Role Dropdown -->
        <div class="p-field mb-3">
          <label for="role">Select Role</label>
          <p-dropdown
            id="role"
            [options]="roles"
            [(ngModel)]="selectedRole"
            placeholder="Select a role"
            (onChange)="onRoleChange()">
          </p-dropdown>
        </div>

        <!-- Username Dropdown -->
        <div class="p-field mb-3">
          <label for="username">Select Username</label>
          <p-dropdown
            id="username"
            [options]="users"
            [(ngModel)]="selectedUser"
            optionLabel="userName"
            placeholder="Select a user"
            (onChange)="onUsernameChange()"
            [disabled]="users.length === 0">
          </p-dropdown>
        </div>

        <button
          pButton
          label="Get Functionalities"
          (click)="searchUser()"
          [disabled]="!selectedUser">
        </button>

        <!-- Functionalities Section -->
        <div *ngIf="user" class="mt-4">
          <h4>User: {{ user.userName }} | Role: {{ user.userRole }}</h4>

          <div *ngFor="let func of roleFunctionalities" class="mb-2">
            <p-checkbox
              [binary]="true"
              [label]="func"
              [ngModel]="isChecked(func)"
              (onChange)="onToggle(func, $event)">
            </p-checkbox>
          </div>

          <button
            pButton
            label="Save Changes"
            class="mt-3"
            (click)="saveChanges()">
          </button>
        </div>
      </div>
    </p-card>
  </div>
</div>
